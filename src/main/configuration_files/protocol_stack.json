{
    "protocols_used":["iFabric", "Ethernet", "IPv4","IPv6", "TCP", "UDP"],
    "protocols_definition":{
        "iFabric":{
            "fields": [
                {"name": "header_type", "size": 16},
                {"name": "header_subtype", "size": 16},
                {"name": "next_protocol", "size": 16},
                {"name": "flow_id", "size": 16},
                {"name": "source_id", "size": 16},
                {"name": "destination_id", "size": 16},
                {"name": "reserved", "size": 128}
            ],
            "variables": [
                {"name": "TYPE_iFabric", "size": 16, "value":"0x1212"},
                {"name": "iFabric_next_protocol_TYPE_ETHERNET", "size": 16, "value":"0x0001"},
                {"name": "MAX_iFabric_ID", "size": 32, "value":"1 << 15"}

            ]
        },
        "Ethernet": {
            "fields": [
                {"name": "dstAddr", "size": 48},
                {"name": "srcAddr", "size": 48},
                {"name": "etherType", "size": 16}
            ],
            "variables": [
                {"name": "Ethernet_etherType_TYPE_IPv4", "size": 16, "value":"0x800"},
                {"name": "Ethernet_etherType_TYPE_IPv6", "size": 16, "value":"34525"}
            ]
        },
        "IPv4": {
            "fields": [
                {"name": "version", "size": 4},
                {"name": "ihl", "size": 4},
                {"name": "diffserv", "size": 8},
                {"name": "totalLen", "size": 16},
                {"name": "identification", "size": 16},
                {"name": "flags", "size": 3},
                {"name": "fragOffset", "size": 13},
                {"name": "ttl", "size": 8},
                {"name": "protocol", "size": 8},
                {"name": "hdrChecksum", "size": 16},
                {"name": "srcAddr", "size": 32},
                {"name": "dstAddr", "size": 32}
            ],
            "variables": [
                {"name": "IPv4_protocol_TYPE_TCP", "size": 8, "value":"6"},
                {"name": "IPv4_protocol_TYPE_UDP", "size": 8, "value":"17"}
            ]
        },
        "IPv6": {
            "fields": [
                {"name": "version", "size": 4},
                {"name": "trafficClass", "size": 8},
                {"name": "flowLabel", "size": 20},
                {"name": "length", "size": 16},
                {"name": "nextHdr", "size": 8},
                {"name": "hopLimit", "size": 8},
                {"name": "srcAddr", "size": 128},
                {"name": "dstAddr", "size": 128}
            ],
            "variables": [
                {"name": "IPv6_nextHdr_TYPE_TCP", "size": 8, "value":"6"},
                {"name": "IPv6_nextHdr_TYPE_UDP", "size": 8, "value":"17"}
            ]
        },
        "TCP": {
            "fields": [
                {"name": "srcPort", "size": 16},
                {"name": "dstPort", "size": 16},
                {"name": "seqNo", "size": 32},
                {"name": "ackNo", "size": 32},
                {"name": "dataOffset", "size": 4},
                {"name": "res", "size": 4},
                {"name": "cwr", "size": 1},
                {"name": "ece", "size": 1},
                {"name": "urg", "size": 1},
                {"name": "ack", "size": 1},
                {"name": "psh", "size": 1},
                {"name": "rst", "size": 1},
                {"name": "syn", "size": 1},
                {"name": "fin", "size": 1},
                {"name": "window", "size": 16},
                {"name": "checksum", "size": 16},
                {"name": "urgentPtr", "size": 16}
            ]
        },
        "UDP": {
            "fields": [
                {"name": "srcPort", "size": 32},
                {"name": "dstPort", "size": 32},
                {"name": "length", "size": 16},
                {"name": "checksum", "size": 16}
            ]
        }
    },
    "protocols_stacks":[
        ["Ethernet", "IPv4", "TCP"],
        ["Ethernet", "IPv4", "UDP"],
        ["Ethernet", "IPv4"],
        ["Ethernet", "IPv6", "TCP"],
        ["Ethernet", "IPv6", "UDP"],
        ["Ethernet", "IPv6"],
        ["Ethernet"],
        ["iFabric", "Ethernet", "IPv4", "TCP"],
        ["iFabric", "Ethernet", "IPv4", "UDP"],
        ["iFabric", "Ethernet", "IPv4"],
        ["iFabric", "Ethernet", "IPv6", "TCP"],
        ["iFabric", "Ethernet", "IPv6", "UDP"],
        ["iFabric", "Ethernet", "IPv6"],
        ["iFabric", "Ethernet"]
    ],
    "lookup": {
        "0x1212" : "iFabric" 
    },
    "next_protocols_fields":{
        "iFabric": {"next_protocol_field":"next_protocol", "next_protocol_value": {"Ethernet": "Ethernet_etherType_TYPE_IPv4"}},
        "Ethernet": {"next_protocol_field":"etherType", "next_protocol_value": {"IPv4": "Ethernet_etherType_TYPE_IPv4", "IPv6": "Ethernet_etherType_TYPE_IPv6"}},
        "IPv4": {"next_protocol_field":"protocol", "next_protocol_value": {"TCP": "IPv4_protocol_TYPE_TCP", "UDP": "IPv4_protocol_TYPE_UDP"}},
        "IPv6": {"next_protocol_field":"nextHdr", "next_protocol_value": {"TCP": "IPv6_nextHdr_TYPE_TCP", "UDP": "IPv6_nextHdr_TYPE_UDP"}},
        "TCP": {},
        "UDP": {}
    },
    "match_fields_used":[
        "Ethernet.dstAddr",
        "IPv4.dstAddr"
    ],
    "match_fields_to_learn":[
        "Ethernet.srcAddr"
    ]
}

